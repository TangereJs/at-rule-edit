<!doctype html>
<html>
  <head>
    <meta charset="UTF-8"/>
    <title>at-rule-edit tests</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
    <script src="../../webcomponentsjs/webcomponents-lite.js"></script>
    <script src="../../web-component-tester/browser.js"></script>
    <link rel="import" href="../at-rule-edit.html"/>
    <link rel="import" href="../../iron-test-helpers/iron-test-helpers.html"/>
  </head>
  <body>

    <test-fixture id="propertyTests">
      <template>
        <at-rule-edit></at-rule-edit>
      </template>
    </test-fixture>

    <script>

      function getComputedPropertyValue(elt, propName) {
        var compStyle = window.getComputedStyle(elt);
        var propValue = compStyle.getPropertyValue(propName);
        return propValue;
      }

      suite('disabled tests', function() {
        test('disabled true disables rule and action editing', function() {
          var elt = fixture('propertyTests');

          var conds = elt.$.conditions;
          var acts = elt.$.actions;

          assert.equal(conds.disabled, false);
          assert.equal(acts.disabled, false); 

          elt.disabled = true;

          assert.equal(conds.disabled, true);
          assert.equal(acts.disabled, true); 

        });
      });

      suite('schema tests', function() {
        
        var intSchema = { properties: {} };

        var schemaStr = '{ "properties": {} }';

        var schemaStr2 = '{ "properties": { "elt1": { "type": "string" }, "elt2": { "type": "string" } } }';

        var schema2Obj = {
          properties: {
            elt1: {
              type: "string"
            },
            elt2: {
              type: "string"
            }
          }
        };

        test('set schema to empty string', function() {
          var elt = fixture('propertyTests');
          assert.deepEqual(elt.schema, intSchema);

          elt.scheam = "";
          assert.deepEqual(elt.schema, intSchema);

          assert.deepEqual(elt.$.conditions.schema, intSchema);
          assert.deepEqual(elt.$.actions.schema, intSchema);
        });

        test('set schema to initial value string', function() {
          var elt = fixture('propertyTests');
          assert.deepEqual(elt.schema, intSchema);

          elt.schema = schemaStr;
          assert.deepEqual(elt.schema, intSchema);

          assert.deepEqual(elt.$.conditions.schema, intSchema);
          assert.deepEqual(elt.$.actions.schema, intSchema);
        });

        test('set schema to non empty schema string', function() {
          var elt = fixture('propertyTests');
          assert.deepEqual(elt.schema, intSchema);

          elt.schema = schemaStr2;
          assert.deepEqual(elt.schema, schema2Obj);

          assert.deepEqual(elt.$.conditions.schema, schema2Obj);
          assert.deepEqual(elt.$.actions.schema, schema2Obj);
        });


        // set empty string; expResult scheam === initial value

        // set string as to initial value { properties: {} }; expResult scheam === initial value

        // set string as to a non empty value { properties: { el1: {}, el2: {} } }; expResult scheam === set value



      });

    </script>

  </body>
</html>
